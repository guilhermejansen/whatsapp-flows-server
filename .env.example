# ======================
# SERVER CONFIGURATION
# ======================
NODE_ENV=development
PORT=3000
HOST=0.0.0.0

# Timeout para Flow Endpoint (DEVE ser < 3000ms para evitar timeout do WhatsApp)
FLOW_ENDPOINT_TIMEOUT=2500

# ======================
# DATABASE (PostgreSQL)
# ======================
DATABASE_URL=postgresql://user:password@localhost:5432/whatsapp_flows
DB_HOST=localhost
DB_PORT=5432
DB_NAME=whatsapp_flows
DB_USER=user
DB_PASSWORD=password
DB_POOL_MIN=2
DB_POOL_MAX=10

# ======================
# ENCRYPTION (RSA-2048)
# ======================
# Chave privada RSA (formato PEM com \n)
PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----\nProc-Type: 4,ENCRYPTED\nDEK-Info: AES-256-CBC,xxxx\n\n[base64 content]\n-----END RSA PRIVATE KEY-----"

# Passphrase da chave privada (se criptografada)
PASSPHRASE=your_secure_passphrase_here

# Chave pública RSA (formato PEM)
PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\n[base64 content]\n-----END PUBLIC KEY-----"

# ======================
# WHATSAPP / META API
# ======================
META_APP_SECRET=your_app_secret_here
META_VERIFY_TOKEN=your_verify_token_here
META_ACCESS_TOKEN=your_access_token_here
META_PHONE_NUMBER_ID=your_phone_number_id_here
META_WABA_ID=your_waba_id_here

# ======================
# CALLBACK CONFIGURATION
# ======================
# URL externa para onde enviar eventos de Flow completo
CALLBACK_WEBHOOK_URL=https://your-system.com/api/webhook/flow-response

# Timeout para callback (ms)
CALLBACK_TIMEOUT=5000

# Retries em caso de falha
CALLBACK_MAX_RETRIES=3

# ======================
# SECURITY
# ======================
# API Token for Flow CRUD endpoints (optional, if not set uses META_ACCESS_TOKEN)
# Generate with: openssl rand -hex 32
API_TOKEN=your_secure_api_token_here

# CORS Origins (separados por vírgula)
CORS_ORIGINS=https://your-frontend.com,https://admin.your-system.com

# Rate limiting (requests por minuto)
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# ======================
# LOGGING
# ======================
LOG_LEVEL=info
LOG_FILE_PATH=./logs/app.log
LOG_MAX_FILES=7

# ======================
# FLOW CONFIGURATION
# ======================
# Default flow name when not identified via path parameter or cache
DEFAULT_FLOW_NAME=csat-feedback

# Flow ID for sending messages (get from WhatsApp Manager)
FLOW_ID=your_flow_id_here

# Initial screen name for your Flow (check in Flow JSON)
FLOW_INITIAL_SCREEN=RECOMMEND

# Test phone number for sending flows (format: country code + number, no +)
TEST_PHONE_NUMBER=5511999999999

# ======================
# MESSAGE TEMPLATE
# ======================
# Send method: 'template' (no 24h limit) or 'direct' (requires 24h window)
SEND_METHOD=template

# Template name (from WhatsApp Manager)
TEMPLATE_NAME=message_templates_csat_src_dev_1_0_utility_99e0c

# Template language code
TEMPLATE_LANGUAGE=pt_BR
