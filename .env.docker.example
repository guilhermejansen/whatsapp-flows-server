# ======================
# DOCKER ENVIRONMENT EXAMPLE
# ======================
# Copy this file to .env for Docker usage
# 
# For Docker Hub images:
# docker pull usuario/whatsapp-flow:latest
# docker run --env-file .env -p 3000:3000 usuario/whatsapp-flow:latest

# ======================
# SERVER CONFIGURATION
# ======================
NODE_ENV=production
PORT=3000
HOST=0.0.0.0

# Timeout para Flow Endpoint (DEVE ser < 3000ms para evitar timeout do WhatsApp)
FLOW_ENDPOINT_TIMEOUT=2500

# ======================
# DATABASE (PostgreSQL)
# ======================
# Para docker-compose, use hostname 'postgres'
# Para docker run, use hostname do container ou IP
DATABASE_URL=postgresql://whatsapp_flow:secure_password_change_me@postgres:5432/whatsapp_flows

DB_HOST=postgres
DB_PORT=5432
DB_NAME=whatsapp_flows
DB_USER=whatsapp_flow
DB_PASSWORD=secure_password_change_me
DB_POOL_MIN=2
DB_POOL_MAX=10

# ======================
# ENCRYPTION (RSA-2048)
# ======================
# Gere as chaves dentro do container:
# docker-compose exec app npm run generate-keys
# 
# Copie a saída e cole aqui

PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----\nProc-Type: 4,ENCRYPTED\nDEK-Info: AES-256-CBC,xxxx\n\n[base64 content]\n-----END RSA PRIVATE KEY-----"

# Passphrase da chave privada (se criptografada)
PASSPHRASE=your_secure_passphrase_here

# Chave pública RSA (formato PEM)
PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\n[base64 content]\n-----END PUBLIC KEY-----"

# ======================
# WHATSAPP / META API
# ======================
META_APP_SECRET=your_app_secret_here
META_VERIFY_TOKEN=your_verify_token_here
META_ACCESS_TOKEN=your_access_token_here
META_PHONE_NUMBER_ID=your_phone_number_id_here
META_WABA_ID=your_waba_id_here

# ======================
# CALLBACK CONFIGURATION
# ======================
# URL externa para onde enviar eventos de Flow completo
CALLBACK_WEBHOOK_URL=https://your-system.com/api/webhook/flow-response

# Timeout para callback (ms)
CALLBACK_TIMEOUT=5000

# Retries em caso de falha
CALLBACK_MAX_RETRIES=3

# ======================
# SECURITY
# ======================
# API Token for Flow CRUD endpoints (optional)
# Generate with: openssl rand -hex 32
API_TOKEN=your_secure_api_token_here

# CORS Origins (separados por vírgula)
CORS_ORIGINS=https://your-frontend.com,https://admin.your-system.com

# Rate limiting (requests por minuto)
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# ======================
# LOGGING
# ======================
LOG_LEVEL=info
LOG_FILE_PATH=/app/logs/app.log
LOG_MAX_FILES=7

# ======================
# FLOW CONFIGURATION
# ======================
# Default flow name quando não identificado via path ou cache
DEFAULT_FLOW_NAME=csat-feedback

# Flow ID for sending messages (get from WhatsApp Manager)
FLOW_ID=your_flow_id_here

# Initial screen name for your Flow (check in Flow JSON)
FLOW_INITIAL_SCREEN=RECOMMEND

# Test phone number for sending flows (format: country code + number, no +)
TEST_PHONE_NUMBER=5511999999999

# ======================
# MIGRATIONS
# ======================
# Skip automatic migrations on container startup (default: false)
SKIP_MIGRATIONS=false
